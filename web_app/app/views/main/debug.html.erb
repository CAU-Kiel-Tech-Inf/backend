<h1>Administration</h1>

<% tabnav :administration do %>

  <h3>Einstellungen</h3>
  <dl>
    <dt>Maximale Laufzeit</dt>
    <dd><%= distance_of_time_in_words Delayed::Worker.max_run_time %></dd>
    <dt>Maximale Versuche</dt>
    <dd><%= Delayed::Worker.max_attempts %></dd>
  </dl>

  <h3>Übersicht</h3>
  <table class="data-table">
    <thead>
      <tr>
        <th>ID</th>
        <th style="width: 40%;">Status</th>
        <th>Geplant für</th>
        <th>Begonnen</th>
        <th style="text-align: center;">Prio</th>
        <th style="text-align: center;">Versuche</th>
        <th>Aktualisiert</th>
      </tr>
    </thead>
    <% unless @jobs.empty? %>
      <% @jobs.each do |job| %>
        <tr>
          <td><%= job.id %></td>
          <td>
            <code style="font-size: 11px; line-height: 12px; color: #666;">
      <%=h job.last_error || "OK" %>
            </code>
          </td>
          <td><%= l(job.run_at, :format => "%d.%m.%y, %H:%M Uhr") %></td>
          <td>
            <% if job.locked_at %>
              <%= l(job.locked_at, :format => "%d.%m.%y, %H:%M Uhr") %>
            <% else %>
              -
            <% end %>
          </td>
          <td style="text-align: center;"><%= job.priority %></td>
          <td style="text-align: center;"><%= job.attempts %></td>
          <td>
            <%= l(job.updated_at, :format => "%d.%m.%y, %H:%M Uhr") %>
          </td>
        </tr>
      <% end %>
    <% else %>
      <tr>
        <td colspan="6">Keine Aufträge vorhanden</td>
      </tr>
    <% end %>
  </table>

  <h2>Logdateien</h2>

  <h3>Game Server</h3>
  <div style="overflow: scroll;">
    <pre><%=h @server_log %></pre>
  </div>

  <h3>Game Manager</h3>
  <div style="overflow: scroll;">
    <pre><%=h @manager_log %></pre>
  </div>
<% end %>