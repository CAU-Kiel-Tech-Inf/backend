<% semantic_form_for [@contest, @school] do |f| %>
  <div style="margin-bottom: 15px; border: 2px solid #ccc">
    <b><%= t("views.clue") %>: </b><%= t("views.school_reg_note") %>
  </div>  
  <% f.inputs do %>
    <fieldset style="background-color: #f0f0f0; margin-bottom: 15px">
      <legend><b>Schuldaten</b></legend>
      <%= f.input :name, :required => true %>
      <%= f.input :zipcode, :required => true %>
      <%= f.input :location, :required => true %>
      <%= f.input :state, :required => true, :collection => School::STATES.sort, :prompt => "Bitte wählen..." %>
      <%= f.input :participation_probability, :required => true, :collection => School::PROBS, :prompt => "Bitte wählen..." %>
      <%= f.input :estimated_team_count, :required => true %>
    </fieldset>
    <fieldset style="background-color: #f0f0f0; margin-bottom: 15px">
      <legend><b>Kontaktdaten</b></legend>
      <li class="string">
        <label>
          <%= School.human_attribute_name :contact_name %>: 
        </label>
        <span style="vertical-align: middle">
          <%= @current_user.first_name %>
        </span>
      </li>
      <li class="string">
        <label>
          <%= School.human_attribute_name :contact_last_name %>: 
        </label>
        <span style="vertical-align: middle">
          <%= @current_user.last_name %>
        </span>
      </li>
      <li class="string">
        <label>
          <%= School.human_attribute_name :contact_email %>: 
        </label>
        <span style="vertical-align: middle">
          <%= @current_user.email %>
        </span>
      </li>
      <% functs = ["head", "teacher", "pupil"].collect{|func| [t("acl9.roles.contestant.#{func}"), func]} %>
      <% functs << "Andere" %>
      <%= f.input :contact_function, :required => true, :collection => functs, :prompt => "Bitte wählen..." %> 
      <li id="school_contact_function_other_input" class="string" style="display: none">
        <label for=school_contact_function_other"></label>
        <%= text_field_tag :school_contact_function_other, "", :name => "contact_function_other" %>
      </li>
      <li id="notify_on_contest_progress_input" class="boolean optional">
        <label for="notify_on_contest_progress">
          <%= check_box_tag :notify_on_contest_progress, 1, true, :style => "vertical-align: middle" %> <%= t "views.notify_contest_progress_info" %> 
        </label>
      </li>
    </fieldset>
  <% end %>
  <% f.buttons do %>
    <%= f.commit_button t("actions.save") %> oder
    <%= link_to t("views.back"), contest_url(@contest) %>
  <% end %>
<% end %>
<% javascript_tag do %>
  function update_view() {
    if($("#school_contact_function").val() == "Andere") {
      $("#school_contact_function_other_input").fadeIn(250)
    } else {
      $("#school_contact_function_other_input").fadeOut(250)
    }
  }
  
  $(function() {
    $("#school_contact_function").change(function() {
      update_view();
    })
    update_view();
  })
<% end %>
