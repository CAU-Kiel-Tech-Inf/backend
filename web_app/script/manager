puts "Running SCManager in stand-alone mode, Ctrl+C to quit."
require File.join(File.dirname(__FILE__), '..', 'config', 'environment')

ActiveRecord::Base.logger = Logger.new(STDOUT)
manager = SoChaManager::Manager.new

Signal.trap "INT" do
  puts "Terminating..."
  manager.close
  puts "Manager has been closed"
  exit 1
end

Client.transaction do
  manager.connect!
  manager.play Match.find(142).rounds.first
end

# we must respond to TRAP/SIGINT for Ctrl+C
# so we can't just do an io-wait
while !manager.done?
  sleep 0.1
end

puts "Done."
exit 0
